`goctl` æ˜¯ `go-zero` å¾®æœåŠ¡æ¡†æ¶çš„ä»£ç ç”Ÿæˆå·¥å…·ï¼Œæ”¯æŒé€šè¿‡å‘½ä»¤å¿«é€Ÿç”ŸæˆæœåŠ¡ç›¸å…³çš„ä»£ç ç»“æ„ã€‚å®ƒå†…ç½®äº†å¤šä¸ªå‘½ä»¤ç±»å‹ï¼Œç”¨äºä¸åŒåœºæ™¯ä¸‹çš„ä»£ç ç”Ÿæˆã€‚ä»¥ä¸‹æ˜¯ `goctl` å¸¸ç”¨å‘½ä»¤ç±»å‹åŠå…¶ä½œç”¨ï¼š

---

### âœ… å¸¸è§å‘½ä»¤ç±»å‹åŠè¯´æ˜

| å‘½ä»¤ç±»å‹         | å‘½ä»¤ç¤ºä¾‹                                                      | ä½œç”¨                                                     |
| ------------ | --------------------------------------------------------- | ------------------------------------------------------ |
| **api**      | `goctl api new`<br>`goctl api go`                         | ç”Ÿæˆ API é¡¹ç›®éª¨æ¶æˆ–æ ¹æ® `.api` æ–‡ä»¶ç”Ÿæˆä»£ç ï¼ŒåŒ…æ‹¬ handlerã€logicã€route ç­‰ã€‚ |
| **model**    | `goctl model mysql ddl`<br>`goctl model mysql datasource` | æ ¹æ®æ•°æ®åº“ DDL æˆ–æ•°æ®æºç”Ÿæˆå¯¹åº”çš„ `model`ï¼ˆæ”¯æŒ MySQLï¼‰ã€‚                 |
| **rpc**      | `goctl rpc new`<br>`goctl rpc proto`                      | ç”Ÿæˆ RPC æœåŠ¡æ¡†æ¶æˆ–æ ¹æ® `.proto` æ–‡ä»¶ç”ŸæˆæœåŠ¡ç«¯/å®¢æˆ·ç«¯ä»£ç ã€‚                 |
| **template** | `goctl template init`<br>`goctl template update`          | ç®¡ç† goctl çš„æ¨¡æ¿ï¼Œæ”¯æŒè‡ªå®šä¹‰æ¨¡æ¿ï¼ˆè¦†ç›–é»˜è®¤ç”Ÿæˆé€»è¾‘ï¼‰ã€‚                        |
| **upgrade**  | `goctl upgrade`                                           | å‡çº§ goctl åˆ°æœ€æ–°ç‰ˆæœ¬ã€‚                                        |
| **docker**   | `goctl docker -go`                                        | ä¸ºç”Ÿæˆçš„æœåŠ¡åˆ›å»º Dockerfileã€‚                                   |
| **kube**     | `goctl kube deploy`<br>`goctl kube service`               | ç”Ÿæˆ Kubernetes éƒ¨ç½²å’ŒæœåŠ¡é…ç½®æ–‡ä»¶ã€‚                               |
| **plugin**   | `goctl plugin`                                            | é€šè¿‡æ’ä»¶æ‹“å±•ç”Ÿæˆä»£ç ï¼ˆå¦‚ grpc-gatewayã€swagger ç­‰ï¼‰ã€‚                  |

---

### ğŸ” å„å‘½ä»¤æ›´è¯¦ç»†è¯´æ˜

#### 1. `api`

* ç”¨äºæ„å»º API æœåŠ¡ã€‚
* æ”¯æŒ `.api` æ–‡ä»¶é©±åŠ¨ç”Ÿæˆ handlerã€logicã€configã€routerã€main.go ç­‰æ–‡ä»¶ã€‚
* ç¤ºä¾‹ï¼š

  ```bash
  goctl api new hello
  goctl api go -api hello.api -dir .
  ```

#### 2. `model`

* **`mysql ddl`**ï¼šæ ¹æ® MySQL çš„ `CREATE TABLE` è¯­å¥ç”Ÿæˆ go-zero é£æ ¼çš„ modelï¼ˆå¸¦ CURDï¼‰ã€‚

  ```bash
  goctl model mysql ddl -src schema.sql -dir ./model -c
  ```
* **`mysql datasource`**ï¼šæ ¹æ®æ•°æ®åº“è¿æ¥è‡ªåŠ¨è¯»å–è¡¨ç”Ÿæˆ modelã€‚

  ```bash
  goctl model mysql datasource -url="user:pass@tcp(127.0.0.1:3306)/dbname" -table="users" -dir="./model"
  ```

#### 3. `rpc`

* **`rpc new`**ï¼šåˆå§‹åŒ–ä¸€ä¸ªæ–°çš„ RPC æœåŠ¡ç›®å½•ç»“æ„ã€‚

  ```bash
  goctl rpc new greeter
  ```
* **`rpc proto`**ï¼šæ ¹æ® `.proto` æ–‡ä»¶ç”Ÿæˆå¯¹åº”çš„ logicã€serverã€client ç­‰ä»£ç ã€‚

  ```bash
  goctl rpc proto -src greeter.proto -dir .
  ```

#### 4. `template`

* è‡ªå®šä¹‰æ¨¡æ¿è·¯å¾„ï¼Œé€‚ç”¨äºå¯¹ç”Ÿæˆä»£ç é£æ ¼è¿›è¡Œä¸ªæ€§åŒ–é…ç½®ã€‚

  ```bash
  goctl template init
  goctl template update
  ```

#### 5. `upgrade`

* ä¸€é”®æ›´æ–° `goctl` åˆ°æœ€æ–°ç‰ˆæœ¬ã€‚

  ```bash
  goctl upgrade
  ```

#### 6. `docker`

* å¿«é€Ÿç”Ÿæˆ Dockerfileï¼Œç”¨äºå®¹å™¨åŒ–éƒ¨ç½²ã€‚

  ```bash
  goctl docker -go server.go -o .
  ```

#### 7. `kube`

* å¿«é€Ÿç”Ÿæˆ K8s çš„ `deployment.yaml` å’Œ `service.yaml` é…ç½®ã€‚

  ```bash
  goctl kube deploy -name user-api -namespace dev -image user-api:v1 -o .
  ```

#### 8. `plugin`

* æ”¯æŒæ’ä»¶å¼æ‰©å±•ï¼Œä¾‹å¦‚ç”Ÿæˆ OpenAPI æ–‡æ¡£æˆ–é›†æˆç¬¬ä¸‰æ–¹ä»£ç ã€‚

  ```bash
  goctl plugin -name goctl-swagger -stdin
  ```

---

å¦‚æœä½ ä½¿ç”¨ `goctl --help` ä¹Ÿèƒ½çœ‹åˆ°æ‰€æœ‰å‘½ä»¤å’Œå‚æ•°ã€‚

æ˜¯å¦éœ€è¦æˆ‘ä¸ºä½ æ¼”ç¤ºå…¶ä¸­æŸä¸ªå‘½ä»¤çš„å…·ä½“ä½¿ç”¨æµç¨‹ï¼Ÿ






å¥½çš„ï¼Œå‡è®¾ä½ å·²ç»åœ¨å½“å‰ç›®å½•ä¸‹å‡†å¤‡å¥½äº† `order.api` æ–‡ä»¶ï¼ˆç”¨äºå®šä¹‰æ¥å£ï¼‰ï¼Œå¹¶ä¸”ä½ å¸Œæœ›åœ¨è¯¥ç›®å½•ä¸‹ç”ŸæˆåŸºäº `go-zero` çš„ API æœåŠ¡ä»£ç ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š

---

## âœ… åˆ›å»º API æœåŠ¡çš„å‘½ä»¤

```bash
goctl api go -api order.api -dir .
```

---

## ğŸ§© å‘½ä»¤è¯¦è§£

| å‚æ•°               | å«ä¹‰                                                |
| ---------------- | ------------------------------------------------- |
| `goctl`          | go-zero çš„ä»£ç ç”Ÿæˆå·¥å…·å‘½ä»¤                                 |
| `api`            | è¡¨ç¤ºä½ è¦æ“ä½œçš„æ˜¯ API ç±»å‹çš„é¡¹ç›®                                |
| `go`             | ä½¿ç”¨ `.api` æ–‡ä»¶ç”Ÿæˆ Go é¡¹ç›®ä»£ç                             |
| `-api order.api` | æŒ‡å®šè¾“å…¥çš„ `.api` æ–‡ä»¶åï¼Œé‡Œé¢å®šä¹‰äº†æ‰€æœ‰çš„è·¯ç”±ã€è¯·æ±‚å‚æ•°ã€å“åº”ç»“æ„ç­‰            |
| `-dir .`         | æŒ‡å®šç”Ÿæˆä»£ç çš„ç›®æ ‡ç›®å½•ï¼Œè¿™é‡Œæ˜¯å½“å‰ç›®å½•ï¼Œ`.` è¡¨ç¤ºå’Œ `order.api` æ–‡ä»¶åŒçº§ç›®å½•ä¸‹ç”Ÿæˆ |

---

## ğŸ—‚ï¸ ç”Ÿæˆåç›®å½•ç»“æ„ç¤ºæ„

æ‰§è¡ŒæˆåŠŸåï¼Œå½“å‰ç›®å½•å°†ç”Ÿæˆå¦‚ä¸‹ç»“æ„ï¼š

```
.
â”œâ”€â”€ order.api          # ä½ åŸæœ¬å®šä¹‰çš„ API æ–‡ä»¶
â”œâ”€â”€ etc/
â”‚   â””â”€â”€ order.yaml     # é…ç½®æ–‡ä»¶æ¨¡æ¿
â”œâ”€â”€ internal/
â”‚   â”œâ”€â”€ config/        # é…ç½®è¯»å–é€»è¾‘
â”‚   â”œâ”€â”€ handler/       # æ¯ä¸ªè·¯ç”±å¯¹åº”çš„å¤„ç†å‡½æ•°
â”‚   â”œâ”€â”€ logic/         # æ¯ä¸ªæ¥å£çš„ä¸šåŠ¡é€»è¾‘å®ç°
â”‚   â”œâ”€â”€ svc/           # service contextï¼Œè´¯ç©¿æ•´ä¸ª service ç”Ÿå‘½å‘¨æœŸ
â”‚   â””â”€â”€ types/         # è¯·æ±‚å’Œå“åº”çš„ç»“æ„ä½“å®šä¹‰ï¼ˆå¯é€‰ï¼‰
â””â”€â”€ order.go           # å¯åŠ¨å…¥å£ main å‡½æ•°
```

---

## ğŸ“˜ æç¤º

* `order.api` æ–‡ä»¶çš„å†™æ³•éå¸¸å…³é”®ï¼Œæ˜¯ç”Ÿæˆé€»è¾‘çš„æºå¤´ã€‚å¿…é¡»éµå®ˆ goctl çš„ API DSL è¯­æ³•ã€‚
* `.api` æ–‡ä»¶ä¸­ä¼šå®šä¹‰ï¼š

    * `service` åç§°
    * å„ä¸ª `route`
    * `request/response` ç»“æ„ä½“
* ç”Ÿæˆåå¯ä»¥ç›´æ¥ `go run order.go -f etc/order.yaml` è¿è¡Œèµ·æ¥ã€‚

---

éœ€è¦æˆ‘ä¸ºä½ å±•ç¤ºä¸€ä¸ª `order.api` æ–‡ä»¶çš„æ ‡å‡†å†™æ³•ç¤ºä¾‹å—ï¼Ÿ
